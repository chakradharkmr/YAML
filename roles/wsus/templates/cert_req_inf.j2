[NewRequest]
Subject = "CN={{ ansible_hostname }}.{{ win_domain_name }}, OU={{ cert_ou }}, O={{ cert_o }}, L={{ cert_l }}, S={{ cert_s }}, C={{ cert_c }}"
Exportable = true
KeyLength = 2048 ; Valid key sizes: 1024, 2048, 4096, 8192, 16384
KeySpec = 1 ; Key Exchange - Required for encryption
KeyUsage = 0xA0 ; Digital Signature, Key Encipherment
HashAlgorithm = SHA384
MachineKeySet = true
SMIME = false
PrivateKeyArchive = false
UserProtected = false
UseExistingKeySet = false
ProviderName = "Microsoft RSA SChannel Cryptographic Provider"
RequestType = PKCS10 ; or CMC.

[EnhancedKeyUsageExtension]
; If you are using an enterprise CA the EnhancedKeyUsageExtension section can be omitted
OID=1.3.6.1.5.5.7.3.1 ; Server Authentication
OID=1.3.6.1.5.5.7.3.2 ; Client Authentication

[RequestAttributes]
CertificateTemplate = "WebServer" 

[Extensions]
; If your client operating system is Windows Server 2008, Windows Server 2008 R2, Windows Vista, or Windows 7
; SANs can be included in the Extensions section by using the following text format. Note 2.5.29.17 is the OID for a SAN extension.
2.5.29.17 = "{text}"
_continue_ = "dns={{ ansible_hostname }}.{{ win_domain_name }}&"
_continue_ = "dns={{ ansible_hostname }}&"
_continue_ = "ipaddress={{ ansible_host }}&"
